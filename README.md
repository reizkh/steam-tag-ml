# Прогнозирование тегов игр Steam

## Обзор проекта
Данный проект направлен на предсказание релевантных тегов для игр в Steam на основе их текстовых описаний. Система использует задачу многометочной классификации для сопоставления нескольких описательных тегов каждой игре, опираясь на данные, собранные с платформы Steam.

## Ключевые особенности
- **Модульная архитектура**: абстрактная фабрика моделей (`BaseModelTrainer`) для унификации обучения различных архитектур
- **Поддержка нескольких подходов**:
  - Базовая модель: `DummyClassifier` (стратегия «наиболее частый тег»)
  - Трансформерная модель: `DistilBERT` с замороженным энкодером и обучаемым классификатором
  - Тонкая настройка: полная дообучаемая версия DistilBERT с дифференцированными learning rate для энкодера и головы классификации
- **Автоматизированный сбор данных**: парсинг описаний и тегов напрямую с официального сайта Steam
- **Интеграция с MLflow**: автоматическое логирование гиперпараметров, метрик и артефактов моделей
- **Гибкая конфигурация**: управление параметрами через YAML-файлы (выбор тегов, размер батча, скорости обучения)

## Инструкции по настройке

### Требования
Python 3.10+, PostgreSQL 14+, curl, unzip.

### Установка
Установите зависимости:
```
uv sync
```

Инициализируйте базу данных:
```
psql -U postgres -f data/ddl.sql
```

## Получение данных
Загрузите датасет с Kaggle:
```
chmod +x data/get_dataset.sh
./data/get_dataset.sh
```

Соберите данные об играх Steam (требуется запущенный сервер PostgreSQL):
```
cd data
uv run get_app_details.py
```

Примечание: процесс может занять около часа в зависимости от скорости сети и ограничений со стороны Steam.

## Запуск экспериментов
Базовая модель (константный предиктор):
```
uv run run_baseline.py
```
DistilBERT
Предварительно нужно изменить конфиг в main.py на distilbert.yaml и использовать класс src.models.distilbertDistilBertTrainer
```
uv run main.py
```

DistilBERT с дообучением 
Предварительно нужно изменить конфиг в main.py на distilbert_fine_tune.yaml и использовать класс src.models.distilbertDistilBertFTTrainer
```
uv run main.py
```
## Отслеживание экспериментов
Результаты автоматически логируются в MLflow. Для просмотра запустите:
```
mlflow ui
```

Интерфейс будет доступен по адресу http://localhost:5000 для анализа метрик и параметров моделей.

## Конфигурация
Основные параметры находятся в файлах `configs/db_params.yaml` (подключение к БД) и `configs/baseline.yaml` (доля обучающей выборки, случайное зерно).

## Метрики качества
Базовая модель оценивается по следующим показателям:
- Hamming Accuracy — доля верно предсказанных меток
- Classification Report — точность, полнота и F1-мера для каждого тега
- Основная метрика по которой оцениваются модели — макроусредненный F1 score

## Планы на развитие
1. Использование документных 

## Лицензия
Проект предназначен исключительно для образовательных и исследовательских целей. Контент и данные Steam используются в рамках добросовестного использования для академических исследований. Все права на контент принадлежат компании Valve Corporation.